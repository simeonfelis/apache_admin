# Generated by django template bzr.config

WSGIScriptAliasMatch ^/bzr/.*/\.bzr/smart$ /var/cgi/bzr.wsgi

<Directory /var/www/bzr>
    WSGIApplicationGroup %{GLOBAL}
</Directory>

#The three next lines allow regular GETs to work too
RewriteEngine On
RewriteCond %{REQUEST_URI} !^/bzr/.*/\.bzr/smart$
RewriteRule ^/bzr/(.*/\.bzr/.*)$ /var/www/bzr/$1 [L]

{% if shares %}

<Location /bzr>
        DAV On
        ForceType text/plain
        Options Indexes
        Order Allow,Deny
        Allow from all
        AuthType Digest
        AuthName Login
        AuthDigestDomain /bzr/ https://rfhete470.hs-regensburg.de/bzr/
        AuthDigestProvider file
        AuthUserFile /etc/apache2/passwd.dav
        AuthGroupFile /etc/apache2/groups.dav
        <LimitExcept OPTIONS>
                require group {% for s in shares %}{{ s.share.share_type }}_{{ s.share.name|lower|safe }} {% endfor %}
        </LimitExcept>
#       SSLRequireSSL
        DirectorySlash Off
        DavDepthInfinity on     
</Location>


{% for share in shares %}
<Location /{{ share.share.share_type }}/{{ share.share.name }}>
    DAV on
    ForceType text/plain
    Options indexes
    Order Allow,Deny
    Allow from all
    AuthType Digest
    AuthName Login
    AuthDigestDomain /{{ share.share.share_type }}/ https://rfhete470.hs-regensburg.de/{{ share.share.share_type }}/{{ share.share.name }}/ 
    AuthDigestProvider file
    AuthUserFile /etc/apache2/passwd.dav
    AuthGroupFile /etc/apache2/groups.dav
    <LimitExcept Options>
        require group {{ share.share.share_type }}_{{ share.share.name|lower|safe }} {# {{ share.projects.0.name|lower }} #} 
    </LimitExcept>
    DirectorySlash Off
    DavDepthInfinity on
</Location>
{% endfor %}
# No bzr shares available
{% endif %}

